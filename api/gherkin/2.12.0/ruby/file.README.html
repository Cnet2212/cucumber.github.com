<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: README
  
    &mdash; Gherkin
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <h3><img src="images/bubble_32x32.png"></img> Gherkin 2.12.0</h3>
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'><p><a href="http://travis-ci.org/cucumber/gherkin"><img src="https://secure.travis-ci.org/cucumber/gherkin.png" alt="Build Status" /></a></p>

<p>A fast lexer and parser for the Gherkin language based on Ragel. Gherkin is two things:</p>

<ul>
<li>The language that has evolved out of the Cucumber project.</li>
<li>This library.</li>
</ul>


<p>Supported platforms:</p>

<ul>
<li><a href="https://rubygems.org/gems/gherkin">Ruby</a> 1.8.7-1.9.3 (MRI, JRuby, REE, Rubinius)</li>
<li><a href="http://search.maven.org/#search%7Cga%7C1%7Cgherkin">Pure Java</a> (jar file)</li>
<li><a href="http://search.npmjs.org/#/gherkin">JavaScript</a> (Tested with V8/node.js/Chrome, but might work on other JavaScript engines)</li>
<li><a href="http://nuget.org/List/Packages/gherkin">.NET</a> (dll file)</li>
</ul>


<h2>Installation</h2>

<h3>Ruby/JRuby</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_gherkin'>gherkin</span>
</code></pre>

<h4>Troubleshooting</h4>

<p>On JRuby you may get an error saying:</p>

<pre class="code ruby"><code class="ruby">ERROR:  While executing gem ... (ArgumentError)
undefined class/module YAML::Syck::DefaultKey
</code></pre>

<p>You can get around this problem by upgrading rubygems:</p>

<pre class="code ruby"><code class="ruby">jruby -S gem install rubygems-update
gem update --system
</code></pre>

<p>Another problem you might encounter is:</p>

<pre class="code ruby"><code class="ruby">ERROR: While executing gem ... (ArgumentError)
invalid byte sequence in US-ASCII
</code></pre>

<p>If this happens, try defining your shell's encoding:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Linux
</span><span class='id identifier rubyid_export'>export</span> <span class='const'>LANG</span><span class='op'>=</span><span class='id identifier rubyid_en_US'>en_US</span><span class='period'>.</span><span class='const'>UTF</span><span class='op'>-</span><span class='int'>8</span>

<span class='comment'># OS X
</span><span class='id identifier rubyid_export'>export</span> <span class='const'>LC_CTYPE</span><span class='op'>=</span><span class='id identifier rubyid_en_US'>en_US</span><span class='period'>.</span><span class='const'>UTF</span><span class='op'>-</span><span class='int'>8</span>
</code></pre>

<h3>Node.js</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_npm'>npm</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_gherkin'>gherkin</span>
</code></pre>

<h3>Java</h3>

<p>The jar file is in the central Maven repo.</p>

<pre class="code ruby"><code class="ruby">&lt;dependency&gt;
    &lt;groupId&gt;info.cukes&lt;/groupId&gt;
    &lt;artifactId&gt;gherkin&lt;/artifactId&gt;
    &lt;version&gt;2.12.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<p>You can get it manually from <a href="http://search.maven.org/#browse%7C-2073395818">Maven Central</a></p>

<h3>.NET</h3>

<p>Get the dll from <a href="http://nuget.org/List/Packages/gherkin">NuGet</a></p>

<h2>API Docs</h2>

<ul>
<li><a href="http://cukes.info/api/gherkin/yardoc/">Ruby</a></li>
<li><a href="http://cukes.info/api/gherkin/javadoc/">Java</a></li>
</ul>


<h2>Hacking: Installing the toolchain</h2>

<p>Due to the cross-platform nature of this library, you have to install a lot of tools to build gherkin yourself.
In order to make it easier for occasional contributors to get the development environment up and running, you don't
have to install everything up front. The build scripts should tell you if you are missing something. For example,
you shouldn't have to install MinGW to build windows binaries if you are a Linux user and just want to fix a bug in
the C code.</p>

<h3>Common dependencies</h3>

<p>These are the minimal tools you need to install:</p>

<ul>
<li>Ragel (brew install ragel or apt-get install ragel)</li>
<li>Ruby (any version should do).</li>
<li>A clone of the cucumber git repo to a "cucumber" sibling folder of your gherkin folder. (Only needed to run cucumber tests)</li>
<li>RVM (you may not need this if you are only building for a single platform)</li>
</ul>


<p>With this minimal tool chain installed, install Ruby gems needed by the build:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_bundler'>bundler</span>
<span class='id identifier rubyid_bundle'>bundle</span> <span class='id identifier rubyid_install'>install</span>
</code></pre>

<p>Running RSpec and Cucumber tests</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rake'>rake</span> <span class='id identifier rubyid_clean'>clean</span> <span class='id identifier rubyid_spec'>spec</span> <span class='id identifier rubyid_cucumber'>cucumber</span>
</code></pre>

<p>If the RL_LANGS environment variable is set, only the parsers for the languages specified there will be built.
E.g. in Bash, export RL_LANGS="en,fr,no". This can be quite helpful when modifying the Ragel grammar.</p>

<p>See subsections for building for a specific platform.</p>

<h3>MRI, REE or Rubinius</h3>

<p>You'll need GCC installed.</p>

<p>Build the gem with:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rake'>rake</span> <span class='id identifier rubyid_build'>build</span>
</code></pre>

<h3>Pure Java and JRuby</h3>

<p>You must install JRuby to build the pure Java jar or the JRuby gem:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rvm'>rvm</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_jruby'>jruby</span>
<span class='id identifier rubyid_rvm'>rvm</span> <span class='id identifier rubyid_use'>use</span> <span class='id identifier rubyid_jruby'>jruby</span>
<span class='id identifier rubyid_rvm'>rvm</span> <span class='id identifier rubyid_gemset'>gemset</span> <span class='id identifier rubyid_create'>create</span> <span class='id identifier rubyid_cucumber'>cucumber</span>
<span class='id identifier rubyid_rvm'>rvm</span> <span class='id identifier rubyid_gemset'>gemset</span> <span class='id identifier rubyid_use'>use</span> <span class='id identifier rubyid_cucumber'>cucumber</span>
<span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_bundler'>bundler</span>
<span class='id identifier rubyid_bundle'>bundle</span> <span class='id identifier rubyid_install'>install</span>
</code></pre>

<p>Now you can build the jar with:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rake'>rake</span> <span class='id identifier rubyid_clean'>clean</span> <span class='id identifier rubyid_jar'>jar</span>
</code></pre>

<h3>JavaScript</h3>

<p>In order to build and test Gherkin for JavaScript you must install:</p>

<ul>
<li>Node.js (0.6.17 or higher with npm)</li>
<li>Ragel with JavaScript support: <a href="http://github.com/dominicmarks/ragel-js">http://github.com/dominicmarks/ragel-js</a>

<ul>
<li>Make sure you have gcc/g++ 4.6 (4.7 is to strict to build ragel-js)</li>
<li>Make sure you have <code>autoconf</code> and <code>automake</code> (<code>brew install automake</code>)</li>
<li>Make sure you have the official ragel (<code>brew install ragel</code>)</li>
<li>Make sure you have kelbt (<code>brew install kelbt</code>). If that fails, install manually from <a href="http://www.complang.org/kelbt/">http://www.complang.org/kelbt/</a></li>
<li><code>cd ragel-js/ragel-svn &amp;&amp; ./autogen.sh &amp;&amp; ./configure --disable-manual</code></li>
<li><code>make &amp;&amp; make install</code></li>
</ul>
</li>
<li>Define the GHERKIN_JS environment variable in your shell (any value will do)</li>
</ul>


<p>Update gems (to install gems which are needed only for js support):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_bundle'>bundle</span> <span class='id identifier rubyid_update'>update</span>
</code></pre>

<p>Now you can build the JavaScript with:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_bundle'>bundle</span> <span class='id identifier rubyid_exec'>exec</span> <span class='id identifier rubyid_rake'>rake</span> <span class='id identifier rubyid_js'>js</span>
</code></pre>

<p>And you can try it out with node.js:</p>

<pre class="code ruby"><code class="ruby">node js/example/print.js spec/gherkin/fixtures/1.feature
</code></pre>

<p>Or the json formatter:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_node'>node</span> <span class='id identifier rubyid_js'>js</span><span class='op'>/</span><span class='id identifier rubyid_example'>example</span><span class='op'>/</span><span class='id identifier rubyid_json_formatter_example'>json_formatter_example</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span>
</code></pre>

<p>If you're hacking and just want to rebuild the English parser:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rake'>rake</span> <span class='id identifier rubyid_js'>js</span><span class='op'>/</span><span class='id identifier rubyid_lib'>lib</span><span class='op'>/</span><span class='id identifier rubyid_gherkin'>gherkin</span><span class='op'>/</span><span class='id identifier rubyid_lexer'>lexer</span><span class='op'>/</span><span class='id identifier rubyid_en'>en</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span>
</code></pre>

<p>In order to test the native JavaScript implementation of JSONFormatter, you also need to define the <code>GHERKIN_JS_NATIVE</code> environment
variable. It's recommended you don't do this permanently, as it will disable testing the Ruby implementation. Try this instead:</p>

<pre class="code ruby"><code class="ruby">GHERKIN_JS_NATIVE=true GHERKIN_JS=true bundle exec rake
</code></pre>

<p>TODO: Make all specs pass with js lexer - replace 'c(listener)' with 'js(listener)' in i18n.rb</p>

<h3>.NET dll</h3>

<p>You must install Mono SDK 2.10.8. The OS X package installer is not recommended as it modifies your system PATH and makes Homebrew unhappy. Install with homebrew instead:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_brew'>brew</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_ikvm'>ikvm</span><span class='op'>/</span><span class='id identifier rubyid_mono'>mono</span><span class='period'>.</span><span class='id identifier rubyid_rb'>rb</span>
</code></pre>

<p>You must also download NuGet.exe from <a href="http://nuget.codeplex.com/releases">CodePlex</a> and place it in <code>/usr/local/nuget/NuGet.exe</code>. When it's installed, update it and register your NuGet API Key:</p>

<pre class="code ruby"><code class="ruby"># In case we need to update
mono /usr/local/nuget/NuGet.exe Update -self

# The key is at https://nuget.org/account
mono --runtime=v4.0.30319 /usr/local/nuget/NuGet.exe SetApiKey xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx
(Note: you may need to run 'mozroots --import --sync' to help mono trusts https setificate, see http://monomvc.wordpress.com/2012/03/06/nuget-on-mono/ for more information)
</code></pre>

<p>Now you can build the .NET dll with:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_mkdir'>mkdir</span> <span class='id identifier rubyid_release'>release</span>
<span class='id identifier rubyid_rake'>rake</span> <span class='id identifier rubyid_ikvm'>ikvm</span>
<span class='id identifier rubyid_rake'>rake</span> <span class='id identifier rubyid_release'>release</span><span class='op'>/</span><span class='id identifier rubyid_nuspec'>nuspec</span><span class='op'>/</span><span class='id identifier rubyid_lib'>lib</span><span class='op'>/</span><span class='id identifier rubyid_gherkin'>gherkin</span><span class='period'>.</span><span class='id identifier rubyid_dll'>dll</span>
</code></pre>

<p>This should build <code>release/nuspec/lib/gherkin.dll</code></p>

<h3>MinGW Rubies (for Windows gems)</h3>

<p>In order to build Windows binaries (so we can release Windows gems from OS X/Linux) we first need to install MinGW:</p>

<pre class="code ruby"><code class="ruby">./install_mingw_os_x.sh
</code></pre>

<p>Now, make sure you have openssl installed - it's needed to build the rubies.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_brew'>brew</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_openssl'>openssl</span>
</code></pre>

<p>Next, we're going to install Ruby 1.8.7 and Ruby 1.9.3 for MinGW. We need both versions so we can build Windows binaries for both.
OS X Lion (or later) doesn't ship with an LLVM free gcc, which you will need in order to install ruby 1.8.7. We can install it with:</p>

<pre class="code ruby"><code class="ruby">brew install https://raw.github.com/Homebrew/homebrew-dupes/master/apple-gcc42.rb
export PATH=/usr/local/mingw/bin:$PATH
# Test that it's on your PATH
i686-w64-mingw32-gcc -v
</code></pre>

<p>For more info see:</p>

<ul>
<li><a href="http://stackoverflow.com/questions/6170813/why-cant-i-install-rails-on-lion-using-rvm">http://stackoverflow.com/questions/6170813/why-cant-i-install-rails-on-lion-using-rvm</a></li>
<li><a href="https://github.com/mxcl/homebrew/wiki/Custom-GCC-and-cross-compilers">https://github.com/mxcl/homebrew/wiki/Custom-GCC-and-cross-compilers</a></li>
</ul>


<p>Now we're ready to install the Windows rubies:</p>

<pre class="code ruby"><code class="ruby">unset GHERKIN_JS

# 1.9.3
rvm install 1.9.3-p392
rvm use 1.9.3-p392
rvm gemset use cucumber --create
gem install bundler
bundle install
PATH=/usr/local/mingw/bin:$PATH CC=/usr/local/mingw/bin/i686-w64-mingw32-gcc rake-compiler cross-ruby VERSION=1.9.3-p392

# 1.8.7
CC=gcc-4.2 rvm install 1.8.7-p371
rvm use 1.8.7-p371
rvm gemset use cucumber --create
gem install bundler
bundle install
PATH=/usr/local/mingw/bin:$PATH CC=/usr/local/mingw/bin/i686-w64-mingw32-gcc rake-compiler cross-ruby VERSION=1.8.7-p371
</code></pre>

<p>Now you can build Windows gems:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rake'>rake</span> <span class='id identifier rubyid_compile'>compile</span>
<span class='id identifier rubyid_mkdir'>mkdir</span> <span class='id identifier rubyid_release'>release</span>
<span class='id identifier rubyid_rake'>rake</span> <span class='label'>gems:</span><span class='id identifier rubyid_win'>win</span>
</code></pre>

<h2>Release process</h2>

<p>Make sure you have access to all the servers where packages are being uploaded:</p>

<ul>
<li>npm registry: <code>npm login</code></li>
<li>rubygems.org: <code>gem push</code></li>
<li>cukes.info: <code>ssh cukes.info</code></li>
<li>sonatype: Check <code>~/.m2/settings.xml</code> and that you have gnupg (OS X users: Install <a href="http://www.gpgtools.org/installer/index.html">GPGTools</a>)

<ul>
<li>Make sure you have a key <a href="https://docs.sonatype.org/display/Repository/How+To+Generate+PGP+Signatures+With+Maven">with no sub-key</a></li>
</ul>
</li>
<li>nuget: See .NET section above</li>
</ul>


<p>Run tests once with GHERKIN_JS_NATIVE=true:</p>

<pre class="code ruby"><code class="ruby">GHERKIN_JS_NATIVE=true GHERKIN_JS=true bundle exec rake
</code></pre>

<p>Now we can release:</p>

<ul>
<li>Make sure GHERKIN_JS is defined (see JavaScript section above)</li>
<li>Bump version in:

<ul>
<li>This file (Installation/Java section)</li>
<li>lib/gherkin/platform.rb</li>
<li>java/pom.xml</li>
<li>js/package.json</li>
<li>History.md</li>
</ul>
</li>
<li>Run <code>bundle update</code>, so Gemfile.lock gets updated with the changes.</li>
<li>Commit changes, otherwise you will get an error at the end when a tag is made.</li>
<li>Run <code>i686-w64-mingw32-gcc -v &amp;&amp; bundle exec rake gems:prepare &amp;&amp; ./build_native_gems.sh &amp;&amp; bundle exec rake release:ALL</code></li>
</ul>


<h2>Note on Patches/Pull Requests</h2>

<ul>
<li>Fork the project.</li>
<li>Run <code>bundle install</code> to install dependencies.</li>
<li>Run <code>rake</code> to make sure all the tests are passing.</li>
<li>Make your feature addition or bug fix.</li>
<li>Add tests for it. This is important so I don't break it in a future version unintentionally.</li>
<li>Commit, do not mess with History.md.</li>
<li>Send me a pull request. Bonus points for topic branches.</li>
</ul>


<h2>Copyright</h2>

<p>Copyright (c) 2009-2013 Mike Sassak, Gregory Hnatiuk, Aslak Hellesøy. See LICENSE for details.</p>
</div></div>
    
    <div id="footer">
  Generated on Sun Apr 21 13:04:30 2013 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.6.1 (ruby-1.9.3).
</div>

  </body>
</html>